{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Sam_Bhatti/Desktop/code%20%283%29/lib/auth-utils.ts"],"sourcesContent":["export const AUTH_TOKEN_KEY = \"rahmah_admin_token\"\r\n\r\n// Save token in cookies and localStorage\r\nexport function setAuthToken(token: string): void {\r\n  if (typeof window === \"undefined\") return\r\n  localStorage.setItem(AUTH_TOKEN_KEY, token)\r\n  // Cookie expires in 1 hour for middleware\r\n  document.cookie = `${AUTH_TOKEN_KEY}=${token}; path=/; max-age=3600; secure; samesite=lax`\r\n}\r\n\r\n// Get token from localStorage or cookies\r\nexport function getAuthToken(): string | null {\r\n  if (typeof window === \"undefined\") return null\r\n  // Try localStorage first (client-side preference)\r\n  const token = localStorage.getItem(AUTH_TOKEN_KEY)\r\n  if (token) return token\r\n\r\n  // Fall back to cookies\r\n  const match = document.cookie.match(new RegExp(\"(^| )\" + AUTH_TOKEN_KEY + \"=([^;]+)\"))\r\n  return match ? match[2] : null\r\n}\r\n\r\n// Remove token from both storage locations\r\nexport function removeAuthToken(): void {\r\n  if (typeof window === \"undefined\") return\r\n  localStorage.removeItem(AUTH_TOKEN_KEY)\r\n  document.cookie = `${AUTH_TOKEN_KEY}=; path=/; max-age=0`\r\n}\r\n\r\n// Client-side helper\r\nexport function isAuthenticated(): boolean {\r\n  return !!getAuthToken()\r\n}\r\n\r\nexport const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL\r\n\r\nexport async function authenticatedFetch(url: string, options: RequestInit = {}) {\r\n  const token = getAuthToken()\r\n  const headers = new Headers(options.headers || {})\r\n\r\n  if (token) {\r\n    headers.set(\"Authorization\", `Bearer ${token}`)\r\n  }\r\n\r\n  return fetch(url, {\r\n    ...options,\r\n    headers,\r\n  })\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAO,MAAM,iBAAiB;AAGvB,SAAS,aAAa,KAAa;IACxC,wCAAmC;;;AAIrC;AAGO,SAAS;IACd,wCAAmC,OAAO;;;IAC1C,kDAAkD;IAClD,MAAM;IAGN,uBAAuB;IACvB,MAAM;AAER;AAGO,SAAS;IACd,wCAAmC;;;AAGrC;AAGO,SAAS;IACd,OAAO,CAAC,CAAC;AACX;AAEO,MAAM;AAEN,eAAe,mBAAmB,GAAW,EAAE,UAAuB,CAAC,CAAC;IAC7E,MAAM,QAAQ;IACd,MAAM,UAAU,IAAI,QAAQ,QAAQ,OAAO,IAAI,CAAC;IAEhD,IAAI,OAAO;QACT,QAAQ,GAAG,CAAC,iBAAiB,CAAC,OAAO,EAAE,OAAO;IAChD;IAEA,OAAO,MAAM,KAAK;QAChB,GAAG,OAAO;QACV;IACF;AACF","debugId":null}},
    {"offset": {"line": 59, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Sam_Bhatti/Desktop/code%20%283%29/app/staff/cases/page.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useEffect, useState } from \"react\"\r\nimport Link from \"next/link\"\r\nimport { Heart, LogOut } from \"lucide-react\"\r\nimport { useRouter } from \"next/navigation\"\r\nimport { getAuthToken, removeAuthToken, authenticatedFetch } from \"@/lib/auth-utils\"\r\n\r\n// interface Document {\r\n//   filename: string\r\n//   originalname: string\r\n//   mimeType: string\r\n//   size: number\r\n//   path: string\r\n//   url: string\r\n// }\r\n\r\ninterface Case {\r\n  caseId: string\r\n  firstName: string\r\n  lastName: string\r\n  requestType: string\r\n  amountRequested: number | null\r\n  status: string\r\n  approvalDate?: string\r\n  createdAt: string\r\n  documents: Array<{\r\n    filename: string\r\n    originalname: string\r\n    mimeType: string\r\n    size: number\r\n    url?: string\r\n  }>\r\n}\r\n\r\ninterface ApiResponse {\r\n  items: Case[]\r\n  total: number\r\n  page: number\r\n  limit: number\r\n}\r\n\r\nexport default function CasesPage() {\r\n  const [cases, setCases] = useState<Case[]>([])\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState<string | null>(null)\r\n  const router = useRouter()\r\n\r\n  // Redirect if no token\r\n  useEffect(() => {\r\n    const token = getAuthToken()\r\n    if (!token) router.push(\"/staff/login\")\r\n  }, [router])\r\n\r\n  // Fetch cases\r\n  useEffect(() => {\r\n    const fetchCases = async () => {\r\n      try {\r\n        const res = await authenticatedFetch(`/api/zakat-applicants`, {\r\n          method: \"GET\",\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n        })\r\n\r\n        if (!res.ok) throw new Error(`API error: ${res.status}`)\r\n\r\n        const result: ApiResponse = await res.json()\r\n        setCases(Array.isArray(result.items) ? result.items : [])\r\n        setError(null)\r\n      } catch (err) {\r\n        console.error(\"Error fetching cases:\", err)\r\n        setError(\"Failed to load cases\")\r\n        setCases([])\r\n      } finally {\r\n        setLoading(false)\r\n      }\r\n    }\r\n\r\n    fetchCases()\r\n  }, [])\r\n\r\n  const handleLogout = () => {\r\n    removeAuthToken()\r\n    router.push(\"/staff/login\")\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100\">\r\n      {/* Header */}\r\n      <header className=\"bg-white border-b border-gray-200 px-8 py-6 shadow-sm\">\r\n        <div className=\"max-w-7xl mx-auto flex items-center justify-between\">\r\n          <div className=\"flex items-center gap-4\">\r\n            <div className=\"w-10 h-10 bg-gradient-to-br from-teal-600 to-cyan-600 rounded-full flex items-center justify-center shadow-lg\">\r\n              <Heart className=\"w-6 h-6 text-white fill-white\" />\r\n            </div>\r\n            <h1 className=\"text-2xl font-bold text-gray-900\">Case Management</h1>\r\n          </div>\r\n          <div className=\"flex items-center gap-4\">\r\n            <Link href=\"/staff/dashboard\" className=\"text-gray-600 hover:text-gray-900 font-medium transition\">\r\n              Dashboard\r\n            </Link>\r\n            <button\r\n              onClick={handleLogout}\r\n              className=\"flex items-center gap-2 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-red-50 hover:text-red-600 rounded-lg transition\"\r\n            >\r\n              <LogOut className=\"w-4 h-4\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </header>\r\n\r\n      {/* Main Content */}\r\n      <div className=\"max-w-7xl mx-auto px-8 py-12\">\r\n        <div className=\"mb-8\">\r\n          <h2 className=\"text-3xl font-bold text-gray-900 mb-2\">All Cases</h2>\r\n          <p className=\"text-gray-600\">Manage and review all applicants</p>\r\n        </div>\r\n\r\n        {loading && <div className=\"bg-white rounded-lg p-12 text-center text-gray-600\">Loading cases...</div>}\r\n        {error && <div className=\"bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg mb-6\">{error}</div>}\r\n        {!loading && !error && cases.length === 0 && (\r\n          <div className=\"bg-white rounded-lg p-12 text-center text-gray-600\">No cases found</div>\r\n        )}\r\n\r\n        {/* Cases Grid */}\r\n        <div className=\"space-y-4\">\r\n          {cases.map((caseItem) => (\r\n            <div\r\n              key={caseItem.caseId}\r\n              className=\"bg-white rounded-lg p-6 shadow-sm hover:shadow-md border border-gray-200 transition\"\r\n            >\r\n              <div className=\"flex items-start justify-between mb-4\">\r\n                <div className=\"flex-1\">\r\n                  <h3 className=\"text-lg font-bold text-gray-900\">\r\n                    {caseItem.firstName} {caseItem.lastName}\r\n                  </h3>\r\n                  <p className=\"text-sm text-gray-600 mt-1\">\r\n                    {caseItem.requestType} Â· ${caseItem.amountRequested || \"N/A\"}\r\n                  </p>\r\n                </div>\r\n                <span\r\n                  className={`px-4 py-2 rounded-full text-sm font-semibold whitespace-nowrap ml-4 ${\r\n                    caseItem.status === \"Pending\"\r\n                      ? \"bg-yellow-100 text-yellow-800\"\r\n                      : caseItem.status === \"Approved\"\r\n                        ? \"bg-green-100 text-green-800\"\r\n                        : \"bg-red-100 text-red-800\"\r\n                  }`}\r\n                >\r\n                  {caseItem.status}\r\n                </span>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-4 gap-6 text-sm pt-4 border-t border-gray-100\">\r\n                <div>\r\n                  <p className=\"text-gray-600\">Case ID</p>\r\n                  <p className=\"font-mono text-xs text-gray-900 mt-1\">{caseItem.caseId.slice(0, 8)}...</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-gray-600\">Submitted</p>\r\n                  <p className=\"text-gray-900 font-medium mt-1\">{new Date(caseItem.createdAt).toLocaleDateString()}</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-gray-600\">{caseItem.status === \"Approved\" ? \"Approved\" : \"Status\"}</p>\r\n                  <p className=\"text-gray-900 font-medium mt-1\">\r\n                    {caseItem.approvalDate\r\n                      ? new Date(caseItem.approvalDate).toLocaleDateString()\r\n                      : new Date(caseItem.createdAt).toLocaleDateString()}\r\n                  </p>\r\n                </div>\r\n                <div className=\"text-right\">\r\n                  <Link href={`/staff/cases/${caseItem.caseId}`}>\r\n                    <button className=\"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition font-medium\">\r\n                      Review\r\n                    </button>\r\n                  </Link>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}